# 广度优先搜索(BFS)测试用例

## 概述

本测试用例基于 `common.go` 文件中的 Graph 结构和 BFS 函数设计，用于验证广度优先搜索算法的正确性和性能。

## 测试用例设计

### 1. 线性图测试 (TestBFSLinearGraph)
- **图结构**: 0 -> 1 -> 2 -> 3 -> 4
- **测试目标**: 验证在简单线性路径中的BFS搜索
- **期望结果**: 找到从节点0到节点4的最短路径 [0,1,2,3,4]

### 2. 环形图测试 (TestBFSCyclicGraph)
- **图结构**: 0 -> 1 -> 2 -> 3 -> 0 (环形)
- **测试目标**: 验证在有环的图中BFS搜索
- **期望结果**: 找到从节点0到节点3的路径 [0,1,2,3]

### 3. 无路径测试 (TestBFSNoPath)
- **图结构**: 0 -> 1, 2 -> 3 (两个分离的连通分量)
- **测试目标**: 验证在无路径情况下BFS的正确处理
- **期望结果**: 返回 nil

## 图结构实现

### Graph 结构
```go
type Graph struct {
    points int // 顶点个数
    edges  int // 边个数
    adj    map[int]*redblacktree.Tree // 邻接表
}
```

### 关键特性
1. **红黑树邻接表**: 使用红黑树存储每个节点的邻居，保证有序性和高效查找
2. **双向边**: 每条边都是双向的，适合无向图
3. **路径重建**: BFS算法能够重建从起点到终点的完整路径

## BFS算法实现

### 核心逻辑
1. **队列管理**: 使用切片实现队列，先进先出
2. **访问标记**: 使用map记录已访问的节点，避免重复访问
3. **路径记录**: 使用prev数组记录每个节点的前驱节点
4. **红黑树遍历**: 使用迭代器遍历红黑树中的邻居节点

### 时间复杂度
- **时间复杂度**: O(V + E)，其中V是顶点数，E是边数
- **空间复杂度**: O(V)，用于存储队列、访问标记和路径信息

## 运行测试

### 运行所有测试
```bash
go test -v bfs_test.go
```

### 运行基准测试
```bash
go test -bench=. bfs_test.go
```

### 运行特定测试
```bash
# 线性图测试
go test -v -run TestBFSLinearGraph bfs_test.go

# 环形图测试
go test -v -run TestBFSCyclicGraph bfs_test.go

# 无路径测试
go test -v -run TestBFSNoPath bfs_test.go
```

### 使用脚本运行
```bash
chmod +x run_bfs_test.sh
./run_bfs_test.sh
```

## 测试结果验证

### 成功标准
1. **路径正确性**: 返回的路径必须是有效的，从起点到终点
2. **最短路径**: BFS保证找到的是最短路径（按边数计算）
3. **无路径处理**: 当不存在路径时正确返回nil
4. **性能要求**: 在合理时间内完成搜索

### 错误处理
1. **空图处理**: 正确处理空图的情况
2. **无效输入**: 处理起点等于终点的情况
3. **边界条件**: 处理单节点图、双节点图等边界情况

## 扩展测试用例

### 可以添加的测试用例
1. **星形图测试**: 验证中心节点到其他节点的路径
2. **复杂图测试**: 验证在复杂网络结构中的搜索
3. **性能测试**: 验证在大规模图中的性能表现
4. **内存测试**: 验证内存使用情况

### 性能基准
- **小图** (< 100节点): < 1ms
- **中图** (100-1000节点): < 10ms
- **大图** (> 1000节点): < 100ms

## 注意事项

1. **依赖管理**: 确保已安装 `github.com/emirpasic/gods` 库
2. **Go版本**: 建议使用 Go 1.21 或更高版本
3. **内存使用**: 大规模图可能消耗较多内存
4. **并发安全**: 当前实现不是并发安全的

## 故障排除

### 常见问题
1. **导入错误**: 检查 `go.mod` 文件中的依赖
2. **编译错误**: 确保Go版本兼容
3. **测试失败**: 检查图结构构建是否正确
4. **性能问题**: 检查红黑树的使用是否正确

### 调试技巧
1. 使用 `fmt.Printf` 打印中间结果
2. 可视化图结构进行验证
3. 使用Go的race detector检查并发问题
4. 使用pprof进行性能分析 